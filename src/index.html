<!doctype html>
<html>
<head>
  <meta charset='utf-8'>
  <title>RuleJS - Like excel library to parse formulas.</title>

  <script src="lib/underscore.string/underscore.string.js"></script>
  <script src="lib/moment/moment.js"></script>
  <script src="lib/lodash/lodash.js"></script>
  <script src="lib/numeral/numeral.js"></script>
  <script src="lib/numericjs/numeric.js"></script>
  <script src="lib/js-md5/md5.js"></script>
  <script src="lib/jstat/jstat.js"></script>
  <script src="lib/formulajs/formula.js"></script>

  <script src="js/parser.js"></script>
  <script src="js/ruleJS.js"></script>

</head>
<body>
<div style="float: left; width: 50%">
  <h1>RuleJS</h1>
  <input type="text" placeholder="ex. AND(1,0)"><button>Parse</button>

  <p style="display: none">result: <span id="result"></span></p>
  <p style="display: none">error: <span id="error"></span></p>
</div>

<div style="float: left; width: 45%">
  <h2>List of supported formulas:</h2>
  <div id="suportedList" style="height: 400px; overflow-y: scroll;"></div>
</div>

<script>
  (function () {

    var button = document.querySelector('button'),
        input = document.querySelector('input[type=text]'),
        result = document.querySelector('#result'),
        error = document.querySelector('#error');

    button.addEventListener('click', function () {
      result.parentNode.style.display = 'none';
      error.parentNode.style.display = 'none';

      var parsed = ruleJS.parse(input.value);

      if (parsed.result !== null) {
        result.parentNode.style.display = '';
        result.innerText = parsed.result;
      }

      if (parsed.error) {
        error.parentNode.style.display = '';
        error.innerText = parsed.error;
      }
    });

    var listFormulas = (function() {
      var container = document.querySelector('#suportedList'),
        ul = document.createElement('ul');

      container.appendChild(ul);

      var methods = [];

      for (var method in ruleJS.formulas) {
        methods.push(method);
      }

      methods.sort();

      methods.forEach(function (item) {
        var li = document.createElement('li'),
          a = document.createElement('a');

        a.href = 'http://www.stoic.com/pages/formula/function?function=' + item;
        a.target = '_blank';
        a.innerHTML = item;

        li.appendChild(a);
        ul.appendChild(li);
      });

    })();

  })();
</script>
</body>
</html>
